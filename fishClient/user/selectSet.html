<!-- HTML5文件 -->
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no"/>
    <meta content="telephone=no,email=no" name="format-detection">
    <meta name="wap-font-scale" content="no">
    <title>选择座位</title>
    <!-- ui框架引入css -->
    <link href="../public/css/weui.min.css" rel="stylesheet" type="text/css"/>
    <link href="../public/css/jquery-weui.min.css" rel="stylesheet" type="text/css"/>
    <!-- 公用样式css -->
    <link href="../public/css/base.css" rel="stylesheet" type="text/css"/>
    <!-- 界面引入css -->
    <link href="../public/css/app/user/index.css" rel="stylesheet" type="text/css"/>
    <link href="http://www.bootcss.com/p/buttons/css/buttons.css" rel="stylesheet" type="text/css"/>

</head>
<body onbeforeunload="return exitWin()">
<div class="main bot44">
    <div class="now-time">
        今天<span class="curr-time"></span>
    </div>
    <div id="set">
        <table style="width: 100%;">
            <tr>
                <td class="set-left"><input type="button" value="1"></td>
                <td class="set-he" rowspan="20">
                    <ul>
                        <li><img src="../public/images/kexuan.png"/><label>可选</label></li>
                        <li><img src="../public/images/yixuan.png"/><label>已选</label></li>
                        <li><img src="../public/images/yishou.png"/><label>已售</label></li>
                    </ul>
                    <br/><br/>
                    <h5>&nbsp;&nbsp;&nbsp;您当前已选座位号</h5>
                    <div id="selectSetId"></div>
                </td>
                <td class="set-right" rowspan="2"><div class="rukou">入口</div></td>
            </tr>
            <tr>
                <td class="set-left"><input type="button" value="3" id="seat3"/></td>
            </tr>
            <tr>
                <td class="set-left"><input type="button" value="5" id="seat5"/></td>
                <td class="set-right"><input type="button" value="2" id="seat2"/></td>
            </tr>
            <tr>
                <td class="set-left"><input type="button" value="7" id="seat7"></td>
                <td class="set-right"><input type="button" value="4" id="seat4"/></td>
            </tr>
            <tr>
                <td class="set-left"><input type="button" value="9" id="seat9"/></td>
                <td class="set-right"><input type="button" value="6" id="seat6"/></td>
            </tr>
            <tr>
                <td class="set-left"><input type="button" value="11" id="seat11"/></td>
                <td class="set-right"><input type="button" value="8" id="seat8"/></td>
            </tr>
            <tr>
                <td class="set-left"><input type="button" value="13" id="seat13"/></td>
                <td class="set-right"><input type="button" value="10" id="seat10"/></td>
            </tr>
            <tr>
                <td class="set-left"><input type="button" value="15" id="seat15"/></td>
                <td class="set-right"><input type="button" value="12" id="seat12"/></td>
            </tr>
            <tr>
                <td class="set-left"><input type="button" value="17" id="seat17"/></td>
                <td class="set-right"><input type="button" value="14" id="seat14"/></td>
            </tr>
            <tr>
                <td class="set-left"><input type="button" value="19" id="seat19"/></td>
                <td class="set-right"><input type="button" value="16" id="seat16"/></td>
            </tr>
            <tr>
                <td class="set-left"><input type="button" value="21" id="seat21"/></td>
                <td class="set-right"><input type="button" value="18" id="seat18"/></td>
            </tr>
            <tr>
                <td class="set-left"><input type="button" value="23" id="seat23"/></td>
                <td class="set-right"><input type="button" value="20" id="seat20"/></td>
            </tr>
            <tr>
                <td class="set-left"><input type="button" value="25" id="seat25"/></td>
                <td class="set-right"><input type="button" value="22" id="seat22"/></td>
            </tr>
            <tr>
                <td class="set-left"><input type="button" value="27" id="seat27"/></td>
                <td class="set-right"><input type="button" value="24" id="seat24"/></td>
            </tr>
            <tr>
                <td class="set-left"><input type="button" value="29" id="seat29"/></td>
                <td class="set-right"><input type="button" value="26" id="seat26"/></td>
            </tr>
            <tr>
                <td class="set-left"><input type="button" value="31" id="seat31"/></td>
                <td class="set-right"><input type="button" value="28" id="seat28"/></td>
            </tr>
            <tr>
                <td class="set-left"><input type="button" value="33" id="seat33"/></td>
                <td class="set-right"><input type="button" value="30" id="seat30"/></td>
            </tr>
            <tr>
                <td class="set-left"><input type="button" value="35" id="seat35"/></td>
                <td class="set-right"><input type="button" value="32" id="seat32"/></td>
            </tr>
            <tr>
                <td class="set-left"><input type="button" value="37" id="seat37"/></td>
                <td class="set-right"><input type="button" value="34" id="seat34"/></td>
            </tr>
            <tr>
                <td class="set-left"><input type="button" value="39" id="seat39"/></td>
                <td class="set-right"><input type="button" value="36" id="seat36"/></td>
            </tr>
        </table>

        <input type="text"  hidden id="appId" value="">
        <input type="text"  hidden id="timeStamp" value="">
        <input type="text"  hidden id="nonceStr" value="">
        <input type="text"  hidden id="package" value="">
        <input type="text"  hidden id="paySign" value="">
        <input type="text"  hidden id="selectSet" value="">
        <input type="text"  hidden id="name" value="">
        <input type="text"  hidden id="totalMoney" value="">
        <div style="text-align: center;margin-top: 20px;">
            <!--<a href="javascript:void(0);" onclick="onUnifiedOrder();">确认支付</a>-->
            <a href="javascript:void(0);" class="button button-3d button-caution" onclick="onUnifiedOrder();">确认支付</a>
        </div>

        <!--<a href="http://www.bootcss.com/" class="button button-royal button-pill button-giant">Go</a>-->
    </div>

</div>
<!-- footer -->
<footer class="footer">
    <div class="weui-tabbar">
        <a href="../index.html" class="weui-tabbar__item">
            <div class="weui-tabbar__icon">
                <img src="../public/images/icon/home-sel.png" alt="">
            </div>
            <p class="weui-tabbar__label">门票购买</p>
        </a>
        <a href="../order/index.html" class="weui-tabbar__item">
            <div class="weui-tabbar__icon">
                <img src="../public/images/icon/order.png" alt="">
            </div>
            <p class="weui-tabbar__label">我的订单</p>
        </a>
        <a href="index.html" class="weui-tabbar__item weui-bar__item--on">
            <div class="weui-tabbar__icon">
                <img src="../public/images/icon/user.png" alt="">
            </div>
            <p class="weui-tabbar__label">个人中心</p>
        </a>
    </div>
</footer>

<!-- jquery引入 -->
<script type="text/javascript" src="../public/js/jquery/jquery.js"></script>
<script type="text/javascript" src="../public/js/jquery/flexible.js"></script>
<!-- weui引入 -->
<script type="text/javascript" src="../public/js/jquery/weui.js"></script>
<!-- 界面对应js -->
<script type="text/javascript" src="../public/js/data/user/selectSet.js"></script>
<script type="text/javascript" src="../public/js/jquery/jquery.cookie.js"></script>
<script type="text/javascript" src="../public/js/app.js"></script>

<script>
    $(document).ready(function(){
        getSeatInfo();
    });

    var yishou=[];
    function getSeatInfo() {
        $.ajax({
            type: "GET",
            url: "/apis/weixin/getSeatNoList",
            dataType: "json",
            contentType: "application/json; charset=utf-8",
            //设置token
            beforeSend: function (request) {
                request.setRequestHeader(tokenKey, $.cookie("token"));
            },
            success: function(data){
                if(data.status=="success"){
                    var result=data.data;
                    console.info(data);
                    for(var i=0;i<result.length;i++){
                        yishou.push(result[i].seatNo);
                    }
                    /**
                     * 已售座位ID
                     * @type inputNO
                     */
                    console.info(yishou);
                    for(var i in yishou){
                        $("input").each(function(){
                            if($(this).val()==yishou[i]){
                                $(this).css("-webkit-filter","grayscale(100%)");
                                $(this).css("box-shadow","#3a3a3a 1px 3px 3px 3px inset");
                            }
                        })
                    }
                }
            }
        });
    }



    /**
     * 左侧座位长短设置
     * @type {number}
     */
    var width = 1;
    $(".set-left").each(function(i){
        if(i<10){
            width+=0.2;
        }else{
            width-=0.2;
        }
        $(this).children("input").css("width",width+"rem")
    })

    /**
     * 右侧座位长短设置
     * @type {number}
     */
    $(".set-right").each(function(i){
        if(i<10){
            width+=0.2;
        }else{
            width-=0.2;
        }
        $(this).children("input").css("width",width+"rem")
    });

    /**
     * 当前选中座位
     * @type {number}
     */
    var curSeat = 0;

    $("input").click(function(){
        if($.inArray(parseInt($(this).val()),yishou)>-1){
            return;
        }
        recoverSeat(curSeat);
        curSeat = $(this).val();
        $("#selectSet").val(curSeat);
        //当前选中的添加样式
        $(this).css("box-shadow","#3a3a3a 1px 3px 3px 3px inset");
        //$(this).css("-webkit-filter","grayscale(100%)");
        $("#selectSetId").html(curSeat);

    });

    function recoverSeat (seatNo){
        $("input").each(function(i){
            if($(this).val()==seatNo){
                $(this).css("box-shadow","#3a3a3a 1px 3px 3px 3px");
            }
        })
    }

    /**
     * 定时任务
     * @type {number}
     */
    var interval = setInterval(function () {

    }, 1000)

    /**
     * 销毁定时任务
     */
    function exitWin() {
        confirm("您确定要离开？");
        clearInterval(interval);
    }
</script>
</body>
</html>
